{"version":3,"sources":["common/components/HotspotContainer.jsx"],"names":["HotspotContainer","props","fetchRegionData","regionData","onHotspotCloseButton","clickedRegionInfoObj","HotspotUtils","getRegionDetails","hotspotType","setState","state","previewImage","document","getElementsByClassName","style","display","click","e","getElementById","className","previewVideo","linkTypeId","constants","LINK_TYPE","FACELESSAUDIO","window","jQuery","draggable","containment","renderHotspot","hotspotDetails","hotspotData","source","regionComponent","isFacelessAudio","audioSrc","createHttps","linkUri","audioTitle","title","url","onClose","autoPlay","facelessAudio","page","pagePlaylist","find","item","pagenumber","goToPageNumber","playOrder","location","alt","name","src","items","data","caption","description","id","regionId","anonymous","thumbnail","embeddedMode","standAloneMode","sppHeaderHeight","height","sppPlayer","lastIndex","lastIndexOf","assetID","slice","scriptContent","sppScript","createElement","SPPModal","rootElement","innerText","appendChild","documentElement","clientHeight","parseInt","width","clientWidth","addEventListener","insertBefore","childNodes","open","basePath","isET1CourseId","isStudent","productId","userId","bookData","userName","bookId","bookID","roleTypeId","link","sppModalBody","remove","removeElementsByClass","this","nextProps","type","onClick","tabIndex","Component","injectIntl"],"mappings":"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","file":"static/js/4.eac3fd78.chunk.js","sourcesContent":["/**\n * PEARSON PROPRIETARY AND CONFIDENTIAL INFORMATION SUBJECT TO NDA\n * Copyright Â© 2020 Pearson Education, Inc. All Rights Reserved.\n *\n * NOTICE: All information contained herein is, and remains\n * the property of Pearson Education, Inc. The intellectual and technical concepts contained\n * herein are proprietary to Pearson Education, Inc. and may be covered by U.S. and Foreign Patents,\n * patent applications, and are protected by trade secret or copyright law.\n * Dissemination of this information, reproduction of this material, and copying or distribution of this software\n * is strictly forbidden unless prior written permission is obtained\n * from Pearson Education, Inc.\n */\n\n/**\n * React container component for hotspot\n *\n * @file HotspotContainer.jsx\n * @author Gowtaman Madanselvaraj\n */\n\nimport React, { Component, Fragment } from 'react';\nimport PropTypes from 'prop-types';\nimport { injectIntl } from 'react-intl';\nimport { shapes } from '@greenville/framework';\nimport { AudioPlayer, VideoPlayerPreview, ImageViewerPreview } from '@aquila/media';\n\nimport HotspotUtils from '../utils/HotspotUtils';\nimport '../../assets/styles/hotspot.css';\n\nimport * as constants from '../constants';\n\nclass HotspotContainer extends Component {\n  static propTypes = {\n    regionData: shapes.state.isRequired,\n    productId: shapes.state.isRequired,\n    isStudent: shapes.state.isRequired,\n    userId: shapes.state.isRequired,\n    basePath: shapes.state.isRequired,\n    goToPageNumber: PropTypes.func.isRequired,\n    pagePlaylist: shapes.state.isRequired,\n    isET1CourseId: shapes.state.isRequired,\n    bookData: shapes.state.isRequired,\n    userName: shapes.state.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      regionData: null\n    };\n  }\n\n  componentDidMount() {\n    const { regionData } = this.props;\n\n    if (regionData) this.fetchRegionData(regionData);\n  }\n\n  /**\n   * Method to fetch the hotspot region\n   *\n   * @param {Object} regionData\n  */\n  fetchRegionData = (regionData) => {\n    this.onHotspotCloseButton();\n    const clickedRegionInfoObj = HotspotUtils.getRegionDetails(regionData);\n\n    if (clickedRegionInfoObj.hotspotType === 'IMAGE' || clickedRegionInfoObj.hotspotType === 'VIDEO'\n      || clickedRegionInfoObj.hotspotType === 'AUDIO') {\n      this.setState({ regionData: clickedRegionInfoObj }, () => {\n        if (this.state.regionData.hotspotType === 'IMAGE') {\n          const previewImage = document.getElementsByClassName('preview-image')[0];\n\n          previewImage.style.display = 'none';\n          try {\n            previewImage.click();\n          } catch (e) {\n            // error\n          }\n          document.getElementById('hotspot').className = 'hotspotContent';\n        } else if (this.state.regionData.hotspotType === 'VIDEO') {\n          const previewVideo = document.getElementsByClassName('poster-play-icon')[0];\n\n          previewVideo.style.display = 'none';\n          document.getElementsByClassName('thumb-nail')[0].style.display = 'none';\n          try {\n            document.getElementsByClassName('regionContainer')[0].style.display = 'block';\n            previewVideo.click();\n          } catch (e) {\n            // error\n          }\n          document.getElementById('hotspot').className = 'videoContent';\n        } else if (this.state.regionData.hotspotType === 'AUDIO'\n          && this.state.regionData.linkTypeId === constants.PDF_CONSTANTS.LINK_TYPE.FACELESSAUDIO) {\n          try {\n            document.getElementById('hotspot').className = 'hotspotContent';\n            document.getElementsByClassName('aquila-audio-player')[0].style.display = 'none';\n          } catch (e) {\n            // error\n          }\n          document.getElementById('hotspot').className = 'hotspotContent';\n        }\n        if (this.state.regionData.hotspotType === 'AUDIO'\n          && this.state.regionData.linkTypeId !== constants.PDF_CONSTANTS.LINK_TYPE.FACELESSAUDIO) {\n          try {\n            document.getElementsByClassName('aquila-audio-player')[0].style.display = 'flex';\n            document.getElementsByClassName('regionContainer')[0].style.display = 'block';\n            document.getElementById('regionCloseBtn').style.display = 'block';\n            window.jQuery('.regionContainer').draggable({\n              containment : \"#root\"\n            });\n          } catch (e) {\n            // error\n          }\n          document.getElementById('hotspot').className = 'hotspotContent';\n        }\n      });\n    } else {\n      this.renderHotspot(clickedRegionInfoObj);\n    }\n  }\n\n  /**\n   * Method to render hotspots\n   *\n   * @param {Object} hotspotDetails\n  */\n  renderHotspot = (hotspotDetails) => {\n    let regionComponent = ' ';\n    let hotspotData;\n    let source;\n    const isFacelessAudio = hotspotDetails.linkTypeId === constants.PDF_CONSTANTS.LINK_TYPE.FACELESSAUDIO;\n\n    switch (hotspotDetails.hotspotType) {\n      case 'AUDIO': {\n        source = HotspotUtils.createHttps(hotspotDetails.linkUri);\n        hotspotData = {\n          audioSrc: source,\n          audioTitle: hotspotDetails.title\n        };\n        regionComponent = (\n          <AudioPlayer\n            url={hotspotData.audioSrc}\n            title={hotspotData.audioTitle}\n            onClose={this.onHotspotCloseButton}\n            autoPlay\n            facelessAudio={isFacelessAudio}\n          />\n        );\n        break;\n      }\n      case 'PAGENUMBER': {\n        const page = this.props.pagePlaylist.find((item => item.pagenumber === hotspotDetails.linkUri));\n\n        this.props.goToPageNumber(page && page.playOrder);\n        break;\n      }\n      case 'EMAIL': {\n        window.location = `mailto:${hotspotDetails.linkUri}`;\n        break;\n      }\n      case 'IMAGE': {\n        source = HotspotUtils.createHttps(hotspotDetails.linkUri);\n        hotspotData = {\n          alt: hotspotDetails.name,\n          src: source,\n          title: hotspotDetails.name,\n          items: hotspotDetails\n        };\n        regionComponent = <ImageViewerPreview data={hotspotData} onClose={this.onHotspotCloseButton} />;\n        break;\n      }\n      case 'VIDEO': {\n        source = HotspotUtils.createHttps(hotspotDetails.linkUri);\n        hotspotData = {\n          title: hotspotDetails.name,\n          src: source,\n          caption: hotspotDetails.description || '',\n          id: hotspotDetails.regionId,\n          anonymous: false,\n          thumbnail: {\n            src: ''\n          },\n          alt: hotspotDetails.name\n        };\n        regionComponent = (\n          <VideoPlayerPreview\n            data={hotspotData}\n            embeddedMode={false}\n            standAloneMode\n            onClose={this.onHotspotCloseButton}\n          />\n        );\n        break;\n      }\n      case 'SPPASSET': {\n        source = hotspotDetails.linkUri;\n        const sppHeaderHeight = document.getElementById('sppModalHeader').style.height;\n        const sppPlayer = document.getElementById('sppModalBody');\n        const lastIndex = source.lastIndexOf('/');\n        const assetID = source.slice(lastIndex + 1);\n        const scriptContent = `https://mediaplayer.pearsoncmg.com/assets/_embed.sppModalBody/${assetID}`;\n        const sppScript = document.createElement('SCRIPT');\n        const SPPModal = document.getElementById('sppModal');\n        const rootElement = document.getElementById('root');\n\n        document.getElementById('sppTitle').innerText = hotspotDetails.name;\n        sppScript.src = scriptContent;\n        sppPlayer.appendChild(sppScript);\n        sppPlayer.style.height = `${document.documentElement.clientHeight - parseInt(sppHeaderHeight, 10)}px`;\n        sppPlayer.style.width = `${document.documentElement.clientWidth}px`;\n        document.getElementById('sppCloseBtn').addEventListener('click', this.onHotspotCloseButton);\n        try {\n          rootElement.insertBefore(SPPModal, rootElement.childNodes[0]);\n          SPPModal.style.display = 'block';\n        } catch (e) {\n          // error\n        }\n        break;\n      }\n      case 'DOCUMENT': {\n        window.open(hotspotDetails.linkUri, '_blank');\n        break;\n      }\n      case 'URL': {\n        window.open(hotspotDetails.linkUri, '_blank');\n        break;\n      }\n      case 'LTILINK': {\n        const {\n          basePath, isET1CourseId, isStudent, productId, userId, bookData, userName\n        } = this.props;\n        const bookId = bookData.bookID || bookData.id\n        const roleTypeId = isStudent ? '2' : '3';\n        const link = `${basePath}?json=${hotspotDetails.linkUri}&contextid=${productId}&role=${roleTypeId}&smsuserid=${userId}${isET1CourseId}&bookid=${bookId}&username=${userName}`;\n\n        window.open(link, '_blank');\n        break;\n      }\n      default: {\n        regionComponent = null;\n        break;\n      }\n    }\n\n    return regionComponent;\n  }\n\n\n  /**\n   * Method for removing hotspot content on clicking the close button\n   *\n   */\n  onHotspotCloseButton = () => {\n    try {\n      const sppModalBody = document.getElementById('player-iframesppModalBody');\n\n      if (sppModalBody) {\n        sppModalBody.remove();\n      }\n      document.getElementById('sppModal').style.display = 'none';\n      if (this.state.regionData) {\n        this.setState({ regionData: null });\n      }\n      HotspotUtils.removeElementsByClass('ReactModalPortalAnimated');\n      document.getElementsByClassName('regionContainer').style.display = 'none';\n    } catch (e) {\n      // error\n    }\n  }\n\n  /* eslint-disable camelcase */\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    const { regionData } = nextProps;\n\n    this.fetchRegionData(regionData);\n  }\n  /* eslint-enable camelcase */\n\n  render() {\n    return (\n      <Fragment>\n        {\n          this.state.regionData && (\n            <div className=\"regionContainer\">\n              <button\n                type=\"button\"\n                id=\"regionCloseBtn\"\n                className=\"regionCloseBtn\"\n                onClick={this.onHotspotCloseButton}\n              >\n                &times;\n              </button>\n              <div id=\"hotspot\">{this.renderHotspot(this.state.regionData)}</div>\n            </div>\n          )}\n        <div id=\"sppModal\" className=\"sppModal\" tabIndex=\"-1\">\n          <div id=\"sppModalHeader\" className=\"sppModalHeader\" style={{ height: `${60}px` }}>\n            <span id=\"sppCloseBtn\" className=\"sppCloseBtn\">&times;</span>\n            <p id=\"sppTitle\" className=\"sppTitle\" />\n          </div>\n          <div id=\"sppModalBody\" className=\"sppModalBody\" />\n        </div>\n\n      </Fragment>\n    );\n  }\n}\n\nexport default injectIntl(HotspotContainer);\n"],"sourceRoot":""}