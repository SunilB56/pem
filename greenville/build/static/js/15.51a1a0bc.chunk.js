(window["webpackJsonpone-reader"]=window["webpackJsonpone-reader"]||[]).push([[15],{1890:function(e,t,o){"use strict";o.r(t);var n,c=o(16),a=o(17),r=o(26),s=o(25),i=o(0),u=o.n(i),d=o(45),l=o(1127),h=o(6),f=o(89),g=(o(183),o(258),o(161),o(12)),p=o(3),k=o(134),b=o(32),m=Object(d.inject)("user","language","bookshelfStatus","bookshelf","userStatus","productToken")(n=Object(d.observer)(n=function(e){Object(r.a)(o,e);var t=Object(s.a)(o);function o(e){var n;return Object(c.a)(this,o),(n=t.call(this,e)).updateLaunchDarklyUser=function(){var e=n.props,t=e.user,o=e.ldClient;t.id&&t.ldUserHash&&o.identify({key:t.id,options:{hash:t.ldUserHash}},t.ldUserHash).then((function(e){console.log("ld success")})).catch((function(e){console.log("ld error")}))},n.handleBookClick=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=n.props.match,a=h.default.getStoreRegistry().getStore("lastlocation"),r=c.url,s=e.book_id,i=(e.et1CourseId,e.iseT1,e.idpId,e.product_id),u=(e.last_activity,e.product_entitlements),d=a.userLocation&&a.userLocation.find((function(e){return e.bookId===i})),l=h.default.getStoreRegistry().getStore("user"),f=l.username,k=l.smsUserId,b=l.id,m=o&&""!==o?"&context_id=".concat(o):"",_=d?"&location=".concat(encodeURIComponent(JSON.stringify(d))):"",y="&userPreferredType=".concat(t),v="1"===n.canadianProxy?"&cp=Y":"",S=i,w=!1,O=[p.ud,p.sd,p.kb],P=[p.uc,p.vc,p.Qb,p.tc];O.includes(u.business_model_code)&&(S=s,w=!0),r.indexOf("/bookshelf")>-1&&(r=c.url.split("/bookshelf")[0]),w?window.location.href="".concat(g.a.PAPER_API_BASE_URL,"?custom_bookid=").concat(S,"&custom_smsid=").concat(k,"&custom_pi_id=").concat(b).concat(v).concat(m).concat(_).concat(y,"&custom_person_id=").concat(f):(P.includes(u.business_model_code)&&window.location.host.includes(p.Wc),window.location.href=""!==o?"".concat(r,"/courses/").concat(o,"?").concat(_).concat(y):"".concat(r,"/products/").concat(S,"?").concat(_).concat(y))},n.handleLogout=function(){h.default.logout()},n.userDetail={},n.state={dataFetched:!1},n.canadianProxy=b.a.getQueryParameterbyName("cp"),n}return Object(a.a)(o,[{key:"componentDidMount",value:function(){var e=this,t=this.props,o=t.bookshelf,n=t.productToken,c=h.default.getStoreRegistry().getStore("user");this.userDetail=c,n.fetch(g.a.PRODUCT_TOKEN),o.fetch(),h.default.getEventManager().on(p.kg,(function(t){var o=e.props.ldClient,n=h.default.getStoreRegistry().getStore("launchdarkly");t&&o&&o.getUser()&&n&&""===n.ownerId&&e.updateLaunchDarklyUser()}))}},{key:"render",value:function(){var e=this,t=this.props,o=t.bookshelf,n=t.bookshelfStatus,c=t.language,a=t.userStatus,r=t.productToken,s=(n.error||a.error)&&p.Pc;return h.default.getEventManager().on(p.cb,(function(){e.setState({dataFetched:!0})})),n.error||a.error?u.a.createElement(k.a,{code:s}):u.a.createElement(l.BookshelfComponent,{books:o.books,onBookClick:this.handleBookClick,locale:c.currentLanguage,consoleUrl:g.a.CONSOLE_URL,type:"etext",userDetail:this.userDetail,isBookshelfPending:!r.verified||n.isPending,isUserPending:!r.verified||a.isPending,onLogout:this.handleLogout})}}]),o}(i.Component))||n)||n;t.default=Object(f.withLDConsumer)()(m)}}]);
//# sourceMappingURL=15.51a1a0bc.chunk.js.map