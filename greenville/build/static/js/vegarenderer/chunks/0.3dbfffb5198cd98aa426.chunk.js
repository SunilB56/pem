webpackJsonp_name_([0],{55:function(e,t){"use strict";class o{}t.a=o,Object.defineProperty(o,"getHighlightedDocViewer",{enumerable:!0,writable:!0,value:()=>{const e=document.querySelector("#text_highlight_0_0");if(e){const t=e.parentNode,o=t.id;return-1<o.indexOf("docViewer2")?"docViewer2":-1<o.indexOf("docViewer")?"docViewer":null}return null}}),Object.defineProperty(o,"getNextPage",{enumerable:!0,writable:!0,value:(e,t,o)=>{const n=t.find((t)=>t.id==e);let i=n.index;if(o){if(0===i)return n;i+=1}const a=t[i+1];return a||null}}),Object.defineProperty(o,"getPage",{enumerable:!0,writable:!0,value:(e,t)=>{const o=t.find((t)=>t.id===e);return o||null}}),Object.defineProperty(o,"getPageTitle",{enumerable:!0,writable:!0,value:(e,t)=>{const o=t.find((t)=>t.id===e);return o.pagenumber||e}})},56:function(e,t,o){"use strict";var n=o(0),i=o.n(n),a=o(1),r=o.n(a),d=o(42),l=o.n(d),s=o(2),g=o.n(s),p=o(44),c=o.n(p),h=o(45),f=o.n(h),u=o(46),b=o.n(u),m=Object.assign||function(e){for(var t,o=1;o<arguments.length;o++)for(var n in t=arguments[o],t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e};class S extends n.Component{constructor(...e){var t;return t=super(...e),Object.defineProperty(this,"sendAnalyticsData",{enumerable:!0,writable:!0,value:()=>{var e=this.props;const t=e.audioObject,o=e.bookId,n=e.bookType;s.EventProvider.getEventManager().dispatch({event:"VegaReader Event",category:"Media",action:"Audio",data:{book_id:o,url:t.url,type:t.type,book_type:n}})}}),Object.defineProperty(this,"getKey",{enumerable:!0,writable:!0,value:()=>new Date().getUTCMilliseconds()}),t}shouldComponentUpdate(e){return this.props.isAudioModalShown!==e.isAudioModalShown||(this.props.audioObject&&this.props.audioObject.url===e.audioObject.url?!1:!0)}render(){var e=this.props;const t=e.audioObject,o=e.isAudioModalShown,a=e.isYoungLearnerActive,r=e.onClose;if(o){this.sendAnalyticsData();let e="popoutAudioContainer";return t.type=t.playerType,e=a?`${e} young-learner-audio`:e,Object(n.createElement)(b.a,{open:o,className:e,key:this.getKey()},Object(n.createElement)(i.a.Fragment,null,Object(n.createElement)(f.a,{"aria-label":"Remove",color:"inherit",onClick:r},Object(n.createElement)(p.Icon,{name:"Remove",fontSize:"small",color:"inherit"})),Object(n.createElement)(d.AudioPlayerComponent,m({},t,{useCredentials:!1}))))}return null}}S.propTypes={audioObject:r.a.object,bookId:r.a.string,bookType:r.a.string,isAudioModalShown:r.a.bool,isYoungLearnerActive:r.a.bool,onClose:r.a.func},S.defaultProps={audioObject:{},isAudioModalShown:!1,isYoungLearnerActive:!1,bookId:"",bookType:"",onClose:()=>{}},t.a=S},57:function(e,t,o){"use strict";var n=o(5),i=o.n(n),a=o(6),r=o(4);t.a=class{constructor(e){d.call(this),this.viewerContext=e,this.isSpdf=e.bookType===r.y,this.isEpub=e.bookType===r.v,this.annotationStoreFirstPage=[],this.annotationStoreSecondPage=[]}create(e){const t=e.annotationType,o=e.chapter,n=e.color,i=e.tags,a=e.text,r={color:n,highlight:{content:[],noteText:a||"",ranges:[]}};return r.annotationType=t,r.chapter=o,r.tags=i,r.id=`_${Math.random().toString(36).substr(2,9)}`,r.noteId=r.id,r.shareable=!1,r.text=a||"",this.viewerContext.createHighlight(r),r}delete(e){const t=this.getClickedHighlight(e)[0];if(t){const o=t.isSecondPage,n=this.getStoreIndex(e,o);if(o){const e=this.annotationStoreSecondPage[0].pageId;this.annotationStoreSecondPage.splice(n,1),this.isSpdf?this.restoreSpdfHighlights(this.annotationStoreSecondPage,e,o):this.restoreEpubHighlights(this.annotationStoreSecondPage,this.viewerContext.secondFrame)}else{const e=this.annotationStoreFirstPage[0].pageId;this.annotationStoreFirstPage.splice(n,1),this.isSpdf?this.restoreSpdfHighlights(this.annotationStoreFirstPage,e,o):this.restoreEpubHighlights(this.annotationStoreFirstPage,this.viewerContext.firstFrame)}}}get(){return{highlight:{content:[],noteText:"",ranges:[]}}}getStoreIndex(e,t){let o=[];o=t?this.annotationStoreSecondPage:this.annotationStoreFirstPage;let n=o.findIndex((t)=>t.id===e);if(-1===n){const t=this.viewerContext.props.getServerId(e);n=o.findIndex((e)=>e.id===t)}return n}load(e=[]){const t=this.viewerContext.loadHighlights;0<e.length&&t(this.formatHighlightResponse(e))}sendDimension(){}update(e){const t=e.color,o=e.chapter,n=e.id,i=e.tags,d=e.text,l=this.getClickedHighlight(n)[0],s=l.isSecondPage,g=this.getStoreIndex(n,s),p=this.viewerContext.props.getServerId(n)||n;return l&&(l.id=p,l.noteId=p,l.chapter=o,l.color=t,l.lineColor=a.a.getLineColor(t),l.rgbColor=a.a.hexToRGB(t,r.a),l.highlight.noteText=d,l.data.text=d,l.text=d,l.tags=i,s?(this.annotationStoreSecondPage.splice(g,1),this.annotationStoreSecondPage.push(l),this.isSpdf?this.restoreSpdfHighlights(this.annotationStoreSecondPage,this.annotationStoreSecondPage[0].pageId,s):this.restoreEpubHighlights(this.annotationStoreSecondPage,this.viewerContext.secondFrame)):(this.annotationStoreFirstPage.splice(g,1),this.annotationStoreFirstPage.push(l),this.isSpdf?this.restoreSpdfHighlights(this.annotationStoreFirstPage,this.annotationStoreFirstPage[0].pageId,s):this.restoreEpubHighlights(this.annotationStoreFirstPage,this.viewerContext.firstFrame))),l}};var d=function(){Object.defineProperty(this,"applyEventsOnHighlights",{enumerable:!0,writable:!0,value:(e)=>{const t=e.contentWindow.document,o=t.querySelectorAll("span.readerplus_highlight");if(0<o.length)for(let e=0;e<o.length;e+=1)o[e].addEventListener("click",this.handleHighlightClicked)}}),Object.defineProperty(this,"formatHighlightResponse",{enumerable:!0,writable:!0,value:(e)=>{const t=[];return e.forEach((e)=>{const o=e;e.data&&e.data.ranges&&(!o.data&&(o.data={}),o.data.ranges=e.data.ranges),o.rgbColor=a.a.hexToRGB(o.color,r.a),o.lineColor=a.a.getLineColor(o.color),t.push(o)}),t}}),Object.defineProperty(this,"getChapterDetails",{enumerable:!0,writable:!0,value:(e)=>{let t=[];var o=this.viewerContext;const n=o.context,i=o.props,a=n.learningContext.flatToc,r=this.isEpub&&!i.isFixedLayout;return t=r?a.filter((t)=>{const o=t.id,n=0<=o.toString().indexOf("#")?o.substr(0,o.indexOf("#")):o,i=0<=e.toString().indexOf("#")?e.substr(0,e.indexOf("#")):e;return n===i}):a.filter((t)=>t.id===e),t}}),Object.defineProperty(this,"getClickedHighlight",{enumerable:!0,writable:!0,value:(e)=>{let t=this.annotationStoreFirstPage.filter((t)=>t.id===e),o=!1;if(0<t.length||(o=!0,t=this.annotationStoreSecondPage.filter((t)=>t.id===e)),e.startsWith("_")&&!(0<t.length)){const n=this.viewerContext.props.getServerId(e);o=!1,t=this.annotationStoreFirstPage.filter((e)=>e.id===n),t&&!(0<t.length)&&(o=!0,t=this.annotationStoreSecondPage.filter((e)=>e.id===n))}return t&&t[0]&&(t[0].isSecondPage=o),t}}),Object.defineProperty(this,"getColorCode",{enumerable:!0,writable:!0,value:(e)=>{let t="";return t="Yellow"===e?"#f4d97b":"Green"===e?"#01cbb7":"Pink"===e?"#ffa7d1":"Blue"===e?"#31d0fd":"#9de4cd",t}}),Object.defineProperty(this,"getColorMapping",{enumerable:!0,writable:!0,value:(e)=>{let t="";return t="#ffedad"===e||"#ffcb4e"===e||"#f4d97b"===e?"#f4d97b":"#bbf2b6"===e||"#9de4cd"===e||"#01cbb7"===e?"#01cbb7":"#fed3ec"===e||"#ffadbe"===e||"#ffa7d1"===e?"#ffa7d1":"#7df9fb"===e||"#86d6e6"===e||"#31d0fd"===e?"#31d0fd":"#9de4cd",t}}),Object.defineProperty(this,"getPopupLocation",{enumerable:!0,writable:!0,value:(e)=>{const t=document.querySelector(".pdf-fwr-pc-right").scrollTop;return e.offsetTop-t}}),Object.defineProperty(this,"handleHighlightClicked",{enumerable:!0,writable:!0,value:(e)=>{let t,o=e;this.isSpdf?(t=o.hId,o=o.event):t=o.currentTarget.getAttribute("highlight_id").substring(0,36);let n=this.annotationStoreFirstPage.filter((e)=>e.id===t);0===n.length&&(n=this.annotationStoreSecondPage.filter((e)=>e.id===t));const a=this.getColorMapping(n[0].color),r=(o.currentTarget||o.target).getBoundingClientRect(),d={data:{action:"tap",annotation:{annotationType:n[0].annotationType,chapter:n[0].chapter,color:a,id:n[0].id,noteId:n[0].id,quote:n[0].highlight.selectedText,ranges:n[0].data.ranges,rect:{left:r.left,top:r.top,bottom:r.bottom,right:r.right,width:r.width,height:r.height},highlight:{noteText:n[0].highlight.noteText||"",content:[{type:"text",content:{text:n[0].highlight.selectedText}}]},tags:n[0].tags||[],shareable:!1,text:n[0].highlight.noteText},location:{pageX:783,pageY:this.isSpdf?e.event.clientY:e.clientY+37,screenX:this.isSpdf?e.event.screenX+80:e.screenX+50,screenY:200}},id:n[0].id,sender:"VegaPxeFrame",time:"",type:"user-tapped-highlight"};i.a.publish("user-tapped-highlight",d.data)}}),Object.defineProperty(this,"handleTextSelection",{enumerable:!0,writable:!0,value:(e)=>{if(0<e.selection.length){const t=this.getPopupLocation(e.selection[0])+40;document.querySelector(".annotation")||i.a.publish("user-finished-selection",{top:t,bottom:500,left:e.event.screenX+30})}}}),Object.defineProperty(this,"restoreEpubHighlights",{enumerable:!0,writable:!0,value:(e,t)=>{const o=[...e];var n=this.viewerContext.props;const i=n.highlightUtilities,a=n.isDoublePage;let r="",d="";const l=o.reverse();for(let o=0;o<l.length;o+=1)r=l[o].data?l[o].data.ranges:"",d=`${d+(r||"").split("@")[0]}
      &${l[o].rgbColor}&${l[o].id}&${l[o].lineColor}|`;i.restoreHighlights(d,a,t),this.applyEventsOnHighlights(t)}}),Object.defineProperty(this,"restoreSpdfHighlights",{enumerable:!0,writable:!0,value:(e,t,o)=>{const n=[];let a;const i=this.viewerContext.pdfWrapper;i.removeExistingHighlightElement(o);for(let r=0;r<e.length;r+=1)a={},a.id=e[r].id,a.highlightHash=e[r].data?e[r].data.ranges:"",a.colour=e[r].color||"red",a.rgbColor=e[r].rgbColor,a.lineColor=e[r].lineColor,a.pageNo=t,n.push(a);i.restoreHighlights(n)}})}},58:function(e,t,o){"use strict";var n=o(0),i=o.n(n),a=o(1),r=o.n(a),d=o(2),l=o.n(d),s=o(42),g=o.n(s);class p extends n.PureComponent{sendAnalyticsData(){var e=this.props;const t=e.bookId,o=e.bookType,n=e.videoObject;d.EventProvider.getEventManager().dispatch({event:"VegaReader Event",category:"Media",action:"Video",data:{book_id:t,url:n.src,type:n.type,book_type:o}})}render(){var e=this.props;const t=e.isVideoModalShown,o=e.onClose,i=e.videoObject;return t?(this.sendAnalyticsData(),Object(n.createElement)(s.VideoPlayerPreviewComponent,{data:i,onClose:o,enableTranscripts:!0,standAloneMode:!0,useCredentials:!1})):null}}p.propTypes={bookId:r.a.string,bookType:r.a.string,isVideoModalShown:r.a.bool,onClose:r.a.func,videoObject:r.a.object},p.defaultProps={bookId:"",bookType:"",isVideoModalShown:!1,onClose:()=>{},videoObject:{}},t.a=p},59:function(e,t,o){"use strict";var n=o(5),i=o.n(n),a=o(7),r=o.n(a),d=o(4),l=o(55),s=o(6);t.a=class{constructor(e){Object.defineProperty(this,"getPopupLocation",{enumerable:!0,writable:!0,value:(e)=>{const t=document.querySelector(".pdf-fwr-pc-right").scrollTop;return e.offsetTop-t}}),Object.defineProperty(this,"handleTextSelection",{enumerable:!0,writable:!0,value:(e)=>{if(0<e.selection.length){const t=this.getPopupLocation(e.selection[0])+40;document.querySelector(".annotation")||i.a.publish(a.AnnotationUtil.actions.NewSelection,{top:t,bottom:500,left:e.event.screenX+30})}}}),Object.defineProperty(this,"getColorId",{enumerable:!0,writable:!0,value:(e)=>{let t="";switch(e.toLowerCase()){case"#ffa7d1":t="1";break;case"#f4d97b":t="2";break;case"#01cbb7":t="0";break;case"#31d0fd":t="3";break;default:t="0";}return t}}),Object.defineProperty(this,"handleHighlightClicked",{enumerable:!0,writable:!0,value:(e,t)=>{const o=t.id,n=this.viewerContext.isEt1SpdfContent;let a=!1,r=this.annotationStore.filter((e)=>e.id===o);0===r.length&&(r=this.annotationStoreSecondPage.filter((e)=>e.id===o),a=!0);const l=this.getStoreIndex(o,a),s=n?document.querySelector(".vega-reader-content").scrollTop:0,g=this.viewerContext.props.getServerId(o)||o;if(!g.startsWith("_")){a?this.annotationStoreSecondPage[l].id=g:this.annotationStore[l].id=g;const o=(e.currentTarget||e.target).getBoundingClientRect(),n={action:"tap",annotation:{annotationType:t.annotationType,color:t.color,id:g,quote:t.data.quote,ranges:t.data.ranges,rect:{left:o.left,top:o.top,bottom:o.bottom,right:o.right,width:o.width,height:o.height},text:t.text,shareable:t.shareable,highlight:t.highlight,tags:t.tags||[],title:t.data.title||"",chapter:t.chapter},location:{pageX:o.left-d.g,pageY:o.top+s}};i.a.publish("user-tapped-highlight",n)}}}),this.viewerContext=e,this.annotationStore=[],this.annotationStoreSecondPage=[],this.overlapList=[],this.overlapObj={}}load(e=[]){const t=this.viewerContext.secondFrameId;if(0<e.length){window.$(".fwr-search-text-highlight").remove();const o=!!e[0].pageId&&e[0].pageId===t;o?this.annotationStoreSecondPage=e:this.annotationStore=e;try{this.restoreHighlights(e,o)}catch(t){}}}restoreHighlights(e,t=!1){const o=this.viewerContext.isEt1SpdfContent;t?window.$(".docViewer2 .pdfHighlight").remove():window.$(".docViewer .pdfHighlight").remove();for(let n=0;n<e.length;n+=1)try{const i=e[n].data?e[n].data.ranges:"",a=e[n].pageId||null,r=i.split("@")[0].trim().replace(/(\r\n|\n|\r)/gm,"").replace(/['"]+/g,"");let d=[];if(d=r.split(":"),null!==a||void 0!==a){const i=[];for(let e=0;e<d.length-1;e+=4){const t=new window.WebPDF.PDFRect,o=d[e].split("{")[1].trim(),n=d[e+1].split(",")[1].trim(),a=d[e+2].split(",")[1].trim(),r=d[e+3].split(",")[1].trim(),l=d[e+1].split(",")[0],s=d[e+2].split(",")[0],g=d[e+3].split(",")[0],p=d[e+4].split("}")[0];t[o+""]=parseFloat(l),t[n+""]=parseFloat(s),t[a+""]=parseFloat(g),t[r+""]=parseFloat(p);try{i.push(t)}catch(t){}}try{o?t?window.frame2.customHighlightText(0,i,2):window.frame1.customHighlightText(0,i,1):window.WebPDF.ViewerInstance.highlightText(0,i),this.saveHighlight(a,e[n],t)}catch(t){}}}catch(t){}i.a.publish(d.j)}create(e,t){const o=e.annotationType,n=e.color,i=e.shareable,a=e.tags,r=e.text;var d=this.viewerContext;const s=d.isEt1SpdfContent,g=d.props.pagePlayList,p=d.secondFrameId,c=d.userRoleTypeId;let h,f,u;if(s){const e=l.a.getHighlightedDocViewer();"docViewer2"===e?(f=!0,h=window.frame2.getPluginByName(window.WebPDF.TextSelectPluginName),u=window.frame2.getCurToolHandler().getTextSelectTool().getSelectedText(2)):(h=window.frame1.getPluginByName(window.WebPDF.TextSelectPluginName),u=window.frame1.getCurToolHandler().getTextSelectTool().getSelectedText(1))}else h=window.WebPDF.ViewerInstance.getToolHandlerByName("Select Text"),u=h&&h.getTextSelectService().getSelectedText();const b={highlight:{content:[],ranges:[]},data:{}};let m="";if(u&&""!==u){const e=s?f?h.getCustomSelectedTextRectInfo(2)[0]:h.getCustomSelectedTextRectInfo(1)[0]:h.getTextSelectService().getSelectedTextRectInfo()[0],d=e&&e.selectedRectArray;for(let e=0;e<d.length;e+=1){const t=d[e];0==e?b.rect={left:t.left,right:t.right,top:t.top,bottom:t.bottom}:m+=",",m=`${m}{"left":"${parseFloat(t.left).toFixed(6)}",`+`"top":"${parseFloat(t.top).toFixed(6)}","right":"${parseFloat(t.right).toFixed(6)}",`+`"bottom":"${parseFloat(t.bottom).toFixed(6)}"}`}m=`[${m}]@0.000000`,b.highlight.content.push({type:"text",content:{text:u||"",title:""}}),b.highlight.ranges.push({title:m});const l=f&&p?p:t,S=g.find((e)=>e.id===l),w=S.title;b.contextualInfo={chapterId:S.chapterId||"",chapterTitle:S.chapterTitle||"",title:w||""},b.chapter={contextualInfo:b.contextualInfo,pageTitle:w},b.pageId=l,b.pageNo=S.pagenumber,b.annotationType=o,b.color=n,b.highlight.noteText=r||"",b.selectedText=u,b.shareable=i,b.tags=a,b.text=r||"",b.userRoleTypeId=c,b.id=`_${Math.random().toString(36).substr(2,9)}`,b.data={quote:u||"",ranges:m,text:r||"",title:w||""};try{s?f?window.frame2.customHighlightText(0,d,2):window.frame1.customHighlightText(0,d,1):window.WebPDF.ViewerInstance.highlightText(0,d),this.saveHighlight(0,b,f)}catch(t){}s&&f?this.annotationStoreSecondPage.push(b):this.annotationStore.push(b)}return b}get(){const e=this.viewerContext.isEt1SpdfContent;let t,o,n;if(e){const e=l.a.getHighlightedDocViewer();"docViewer2"===e?(o=!0,t=window.frame2.getPluginByName(window.WebPDF.TextSelectPluginName),n=window.frame2.getCurToolHandler().getTextSelectTool().getSelectedText(2)):(t=window.frame1.getPluginByName(window.WebPDF.TextSelectPluginName),n=window.frame1.getCurToolHandler().getTextSelectTool().getSelectedText(1))}else t=window.WebPDF.ViewerInstance.getToolHandlerByName("Select Text"),n=t&&t.getTextSelectService().getSelectedText();const i={highlight:{content:[],ranges:[]},data:{}};let a="";if(n&&""!==n){const r=e?o?t.getCustomSelectedTextRectInfo(2)[0]:t.getCustomSelectedTextRectInfo(1)[0]:t.getTextSelectService().getSelectedTextRectInfo()[0],d=r&&r.selectedRectArray;for(let e=0;e<d.length;e+=1){const t=d[e];0==e?i.rect={left:t.left,right:t.right,top:t.top,bottom:t.bottom}:a+=",",a=`${a}{"left":"${parseFloat(t.left).toFixed(6)}",`+`"top":"${parseFloat(t.top).toFixed(6)}","right":"${parseFloat(t.right).toFixed(6)}",`+`"bottom":"${parseFloat(t.bottom).toFixed(6)}"}`}a=`[${a}]@0.000000`,i.highlight.content.push({type:"text",content:{text:n||"",title:""}}),i.highlight.ranges.push({title:a}),i.highlight.noteText=""}return i}search(){const e=this.viewerContext.isEt1SpdfContent;let t,o;if(e){const e=l.a.getHighlightedDocViewer();"docViewer2"===e?(t=window.frame2.getCurToolHandler().getTextSelectTool(),o=window.frame2.getCurToolHandler().getTextSelectTool().getSelectedText(2)):(t=window.frame1.getCurToolHandler().getTextSelectTool(),o=window.frame1.getCurToolHandler().getTextSelectTool().getSelectedText(1))}else t=window.WebPDF.ViewerInstance.getToolHandlerByName("Select Text"),o=t&&t.getTextSelectService().getSelectedText();const n={highlight:{content:[]}};return o&&""!==o&&(n.highlight.content.push({type:"text",content:{text:o||"",title:""}}),t.clearSelection()),n}saveHighlight(e,t,o=!1){const n=t.data.ranges,a=t.id,i=t.color,r=document.querySelectorAll(".fwr-search-text-highlight"),l=document.createElement("div"),g=s.a.getLineColor(i),p=s.a.hexToRGB(i,d.a);l.setAttribute("data-id",a),l.setAttribute("highlight-hash",n),l.classList.add("pdfHighlight");for(let n=0;n<r.length&&!(t.annotationType&&t.annotationType.toLowerCase()===d.b);n+=1){const o=document.createElement("div");o.classList.add("fwr-highlight-annot"),o.setAttribute("page-index",e),o.setAttribute("id",a),o.style.left=r[n].style.left,o.style.top=r[n].style.top,o.style.width=r[n].style.width,o.style.height=r[n].style.height,o.style.backgroundColor=p,o.style.borderBottom=`2px solid ${g}`,o.onclick=(e)=>{this.handleHighlightClicked(e,t)},l.appendChild(o)}const c=o?document.getElementById("docViewer2_ViewContainer_PageContainer_0"):document.getElementById("docViewer_ViewContainer_PageContainer_0");c.appendChild(l),window.$(".fwr-search-text-highlight").remove()}update(e){const t=e.chapter,o=e.color,n=e.id,i=e.shareable,a=e.tags,r=e.text,l=this.viewerContext.props.getInternalId,g=this.annotationStoreSecondPage.some((e)=>e.id===n),p=this.getStoreIndex(n,g),c=this.viewerContext.props.getServerId(n)||n,h=g?this.annotationStoreSecondPage[p]:this.annotationStore[p];if(h&&!c.startsWith("_")){h.id=c,h.chapter=t,h.color=o,h.data.text=r,h.text=r,h.highlight.noteText=r,h.shareable=i,h.tags=a;let e=document.querySelector(`[data-id="${n}"]`);e||(e=document.querySelector(`[data-id="${l(n)}"]`));let f="";for(let t=0;e&&t<e.children.length;t+=1)if(f=e.children[t],f){const e=s.a.getLineColor(o),t=s.a.hexToRGB(o,d.a);f.style.backgroundColor=t,f.style.borderBottom=`2px solid ${e}`,!0===i?f.classList.contains("annotator-handle")&&(f.setAttribute("class",""),f.classList.add("annotator-handle",`color-${this.getColorId(o)}`)):(f.classList.remove("color-3"),f.classList.add(`color-${this.getColorId(o)}`))}g?(this.annotationStoreSecondPage.splice(p,1),this.annotationStoreSecondPage.push(h)):(this.annotationStore.splice(p,1),this.annotationStore.push(h))}return h}delete(e){let t=!1;const o=this.viewerContext.props.getServerId(e);let n=this.annotationStore.filter((t)=>t.id===e||t.id===o);0===n.length&&(n=this.annotationStoreSecondPage.filter((t)=>t.id===e||t.id===o),t=!0);const i=this.getStoreIndex(e,t),a=t?this.annotationStoreSecondPage[i]:this.annotationStore[i];if(a){this.annotationStore.splice(i,1);const t=document.querySelector(`[data-id="${a.id}"]`)||document.querySelector(`[data-id="${e}"]`)||document.querySelector(`[data-id="${this.viewerContext.props.getInternalId(e)}"]`);t&&t.remove()}}getStoreIndex(e,t=!1){let o=[];o=t?this.annotationStoreSecondPage:this.annotationStore;let n=o.findIndex((t)=>t.id===e);return-1===n&&(n=o.findIndex((t)=>t.id===this.viewerContext.props.getServerId(e))),n}sendDimension(e){const t=this.viewerContext.props.isDoublePage,o=document.querySelector(".vega-reader-content"),n=document.querySelector(`[data-id="${e}"]`);n&&n.firstElementChild&&(o.scrollTop=n.firstElementChild.offsetTop-60,t&&(o.scrollLeft=n.firstElementChild.offsetLeft))}}},64:function(e,t,o){var n=o(65);"string"==typeof n&&(n=[[e.i,n,""]]);var i,a={hmr:!0};a.transform=i,a.insertInto=void 0;o(9)(n,a);n.locals&&(e.exports=n.locals),!1},65:function(e,t,o){t=e.exports=o(8)(!1),t.push([e.i,"@-moz-document url-prefix(){.spdfContainer .pdf-fwr-pc-main{top:55px}}#pdfLoadingOverlay{position:absolute;z-index:999;width:100%;height:100%;top:0px;left:0;background:rgba(205,205,205,0.4) 50% 50% no-repeat}.viewer-navigation-bottom .spdfContainer .doublePagePDF,.viewer-navigation-bottom .spdfContainer .singlePagePDF{padding-bottom:70px}.spdfContainer .hotspotIcon,.spdfContainer .hotspotIconDouble{position:absolute;z-index:1}.spdfContainer .hotspot{position:absolute;z-index:2}.spdfContainer .hotspot .tooltiptext{visibility:hidden;width:auto;background-color:#F2E9BD;color:#333333;text-align:center;position:absolute;display:inline-block;overflow:hidden;white-space:nowrap;right:0%;top:100%;font-size:13px;font-family:inherit;z-index:2}.spdfContainer .hotspot:hover{cursor:pointer}.spdfContainer .hotspot:hover .tooltiptext{visibility:visible;opacity:1}.spdfContainer .pdf-fwr-pc-main{position:absolute;height:calc(100% - 60px);width:100%;top:50px}.spdfContainer .pdf-fwr-pc-main .pdf-fwr-pc-right{height:100%;overflow:auto}.spdfContainer .pdf-fwr-pc-main .fwr-highlight-annot{opacity:0.7;position:absolute}.spdfContainer .pdf-fwr-pc-main .doublePagePDF .docViewer{float:left;position:relative;height:100%;background:white}.spdfContainer .pdf-fwr-pc-main .doublePagePDF .isHidden{visibility:hidden}.spdfContainer .pdf-fwr-pc-main .doublePagePDF .docViewer2{float:right;height:100%;position:relative;background:white}.spdfContainer .pdf-fwr-pc-main .doublePagePDF .docViewer2 #docViewer2_ViewContainer_Wrap_0{width:0px !important;height:0px !important}.spdfContainer .pdf-fwr-pc-main .doublePagePDF .docViewer2 .fwrJspPane{margin-left:0px !important}.spdfContainer .pdf-fwr-pc-main .doublePagePDF .docViewer2 .fwrJspPane .fwr-page{margin-left:0px !important}.spdfContainer .pdf-fwr-pc-main #docViewer{position:relative;background:white;display:inline-block}.spdfContainer .pdf-fwr-pc-main #docViewer #docViewer_ViewContainer_Wrap_0{height:0px !important}.spdfContainer .pdf-fwr-pc-main #docViewer .fwrJspPane{margin-left:0px !important}.spdfContainer .pdf-fwr-pc-main #docViewer .fwrJspPane .fwr-page{margin-left:0px !important}.spdfContainer .pdf-fwr-pc-main #docViewer-copy-frame{height:0px;width:0px;visibility:hidden}.spdfContainer .pdf-fwr-pc-main #frame{visibility:visible;overflow:visible;width:100%;text-align:center;margin-left:auto;margin-right:auto}.spdfContainer .pdf-fwr-pc-main .fwr_link_annot{cursor:pointer !important;position:absolute;padding-top:10px}.spdfContainer .pdf-fwr-pc-main .fwr-text-highlight{position:absolute;background-color:rgba(121,231,255,0.3);opacity:1.0;filter:alpha(opacity=30);z-index:2}.spdfContainer .pdf-fwr-pc-main #docViewer_ViewContainer{margin-left:0px !important;height:100% !important;width:100% !important}.spdfContainer .pdf-fwr-pc-main #docViewer2_ViewContainer{margin-left:0px !important;height:100% !important;width:100% !important}.spdfContainer .spdfMain{background-color:#dddedf}.spdfContainer .spdfMain .fwr-search-result-highlight{position:absolute;background-color:#D5D5D5;border-bottom:2px solid #000;opacity:0.5;z-index:7}.spdfContainer .spdfMain .hideAnnotation .fwr-highlight-annot{opacity:0}.spdfContainer .popoutAudioContainer{transform:none;left:0px;right:0px}.spdfContainer .popoutAudioContainer .aquila-audio-player{max-width:90%;width:100%;margin:0}.spdfContainer .young-learner-audio{bottom:61px}.young-learner .pdf-fwr-pc-main{height:100%;top:0px}.viewer-content-shift .spdfContainer .popoutAudioContainer{left:470px}#goToPrevPage,#goToNextPage{display:none}\n",""]),t.locals={backGround:"#fff",darkGray:"#252525",brickRed:"#991300",darkBlue:"#1e496c"}},70:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),i=o.n(n),a=o(1),r=o.n(a),d=o(5),l=o.n(d),s=o(7),g=o.n(s),p=o(2),c=o.n(p),h=o(56),f=o(57),u=o(59);class b{}Object.defineProperty(b,"getLinkObject",{enumerable:!0,writable:!0,value:(e,t,o,n)=>{const i={};try{const a=e.getAttribute("link-uri");if(a){const e=b.isVideo(a),t=b.isAudio(a),o=b.getMediaAttributes(a,e,t,n);i.attributes=o}else{const n=parseInt(e.getAttribute("page-index"),10);if(n||0===n){const a=e.getAttribute("annot-name"),r=o(n,a,"docViewer");let d;d=t[0]&&t[1]&&t[0].id===t[1].id&&t[0].index===t[1].index?t[r+1]:t[r],i.attributes={},i.attributes.type="internal",i.attributes.currentPageDetails=d}}}catch(t){}return i}}),Object.defineProperty(b,"isVideo",{enumerable:!0,writable:!0,value:(e)=>-1<e.indexOf(".mp4")||-1<e.indexOf(".avi")}),Object.defineProperty(b,"isAudio",{enumerable:!0,writable:!0,value:(e)=>-1<e.indexOf(".mp3")||-1<e.indexOf(".wav")}),Object.defineProperty(b,"getMediaAttributes",{enumerable:!0,writable:!0,value:(e,t,o,n)=>{const i={};return t?(i.src=e,i.type="video",i.displayTitle=n,i.title=n,i.thumbnail={},i.thumbnail.src="",i.alt=""):o?(i.url=e,i.type="audio",i.playerType="",i.displayTitle=n,i.title=n,i.thumbnail={},i.thumbnail.src="",i.alt=""):(i.type="external",i.src=e),i}});var m=o(58),S=o(55),w=o(6),x=o(4),P=o(3),y=o(64),v=o.n(y);class C extends n.Component{constructor(e){super(e),Object.defineProperty(this,"closePopup",{enumerable:!0,writable:!0,value:()=>{this.setState({isVideoModalShown:!1,isAudioModalShown:!1})}}),Object.defineProperty(this,"createHighlight",{enumerable:!0,writable:!0,value:(e)=>{var t=this.props;const o=t.bookId,n=t.currentPageId,i=t.pagePlayList;let a=!1,r=S.a.getPage(n,i),d=r.index.toString();const l=S.a.getHighlightedDocViewer(),s=e.color,g=w.a.getLineColor(s),c=w.a.hexToRGB(s,x.a),h=this.context.learningContext.titleData;if(l){const t=this.pdfWrapper.createHighlight(l,c,g),s=t.selection||"";"docViewer2"===l&&(a=!0,r=S.a.getNextPage(n,i,window.isVersoStat),d=r&&r.index.toString()),e.annotationType="Highlight",e.lineColor=g,e.pageId=d,e.pageNo=(parseInt(d,10)+1).toString(),e.rect=t.rect,e.rgbColor=c,e.selectedText=s,e.highlight.selectedText=s;const f=h.chapterTitle||h.pageTitle||e.pageNo||"",u=this.annotationInterface.getChapterDetails(r.id);e.title=f,e.contextualInfo={chapterId:u[0]?u[0].chapterId:"",chapterTitle:u[0]?u[0].chapterTitle:h.chapterTitle||"",title:f||""},e.chapter={contextualInfo:e.contextualInfo,pageTitle:f},e.highlight.content.push({type:"text",content:{text:s,title:f}}),e.highlight.ranges.push({title:t.serializedHighlight}),e.quote=s,e.data={bookType:x.y,ranges:t.serializedHighlight,title:f},p.EventProvider.getEventManager().dispatch({event:"VegaReader Event",category:"Highlight",action:"Created",data:{book_title:f,book_id:o,page_index:d}}),a?(this.annotationInterface.annotationStoreSecondPage.push(e),this.annotationInterface.restoreSpdfHighlights(this.annotationInterface.annotationStoreSecondPage,d,a)):(this.annotationInterface.annotationStoreFirstPage.push(e),this.annotationInterface.restoreSpdfHighlights(this.annotationInterface.annotationStoreFirstPage,d,a))}}}),Object.defineProperty(this,"doublePageView",{enumerable:!0,writable:!0,value:()=>this.props.isDoublePage?Object(n.createElement)("div",{id:"docViewer2",className:"docViewer2"}):null}),Object.defineProperty(this,"fetchAnnotation",{enumerable:!0,writable:!0,value:(e)=>{var t=this.props;const o=t.fetchAnnotation,n=t.isDoublePage,i=t.pagePlayList,a=this.getPageIndex(e,i);if(this.firstFrameId=a,o(a),n&&this.isEt1SpdfContent){const t=i.findIndex((t)=>t.id===e),n=i[t+1];n&&(this.secondFrameId=n.id,this.secondFramePageNo=n.pagenumber,o(n.id))}else if(n){const t=S.a.getNextPage(e,i,window.isVersoStat),n=t&&t.id;if(n){const e=this.getPageIndex(n,i);this.secondFrameId=e,o(e)}}}}),Object.defineProperty(this,"getPageIndex",{enumerable:!0,writable:!0,value:(e,t)=>{const o=S.a.getPage(e,t),n=o.index.toString();return n}}),Object.defineProperty(this,"handleLinkClick",{enumerable:!0,writable:!0,value:(e)=>{const t=S.a.getPageTitle(this.props.currentPageId,this.props.pagePlayList),o=b.getLinkObject(e,this.props.pagePlayList,this.pdfWrapper.getInternalLinkToPageNumber,t);switch(o.attributes.type){case"internal":this.props.onPageRequest(o.attributes.currentPageDetails);break;case"external":window.open(o.attributes.src);break;case"video":this.setVideoState(o.attributes);break;case"audio":this.setAudioState(o.attributes);break;default:}}}),Object.defineProperty(this,"handleMedia",{enumerable:!0,writable:!0,value:(e)=>{if(e)switch(e.type){case"video":this.setVideoState(e);break;case"audio":this.setAudioState(e);break;default:}}}),Object.defineProperty(this,"loadHighlights",{enumerable:!0,writable:!0,value:(e)=>{if(0<e.length){const t=e[0].pageId===this.secondFrameId;t?this.annotationInterface.annotationStoreSecondPage=e:this.annotationInterface.annotationStoreFirstPage=e,this.annotationInterface.restoreSpdfHighlights(e,e[0].pageId,t)}}}),Object.defineProperty(this,"manageLoading",{enumerable:!0,writable:!0,value:(e)=>{document.getElementById("pdfLoadingOverlay").style.display=e?"block":"none"}}),Object.defineProperty(this,"pageZoomedHandler",{enumerable:!0,writable:!0,value:()=>{this.isEt1SpdfContent?(l.a.publish("spdfZoomLevelChanged"),this.annotationInterface.restoreHighlights(this.annotationInterface.annotationStore),this.props.isDoublePage&&this.annotationInterface.restoreHighlights(this.annotationInterface.annotationStoreSecondPage,!0)):(this.loadHighlights(this.annotationInterface.annotationStoreFirstPage),this.props.isDoublePage&&this.loadHighlights(this.annotationInterface.annotationStoreSecondPage))}}),Object.defineProperty(this,"removeDomElements",{enumerable:!0,writable:!0,value:()=>{const e=["#fwr-textSelect-context-menu-container","#docViewerFxMenuContainer","#fwr-annots-context-menu-container"];let t;for(let o=0;o<e.length;o+=1)t=this.viewerRef.current.querySelectorAll(e[o]),this.removeElementArray(t)}}),Object.defineProperty(this,"removeElementArray",{enumerable:!0,writable:!0,value:(e)=>{for(let t=0;t<e.length;t+=1)e[t].parentNode&&e[t].parentNode.removeChild(e[t])}}),Object.defineProperty(this,"setAudioState",{enumerable:!0,writable:!0,value:(e)=>{this.setState({isAudioModalShown:!0,isVideoModalShown:!1,audioObject:e})}}),Object.defineProperty(this,"setVideoState",{enumerable:!0,writable:!0,value:(e)=>{this.setState({isVideoModalShown:!0,isAudioModalShown:!1,videoObject:e})}}),Object.defineProperty(this,"updatePageLayout",{enumerable:!0,writable:!0,value:()=>{this.manageLoading(!0),this.props.isDoublePage?window.sessionStorage.setItem(`frame1_${this.props.pdfBookId}_isDoublePageLayout`,!0):window.sessionStorage.setItem(`frame1_${this.props.pdfBookId}_isDoublePageLayout`,!1)}}),Object.defineProperty(this,"updatePdfFrame",{enumerable:!0,writable:!0,value:()=>{var e=this.props;const t=e.currentPageId,o=e.foxitAssetUrl,n=e.isFirstPageRight,i=e.pdfBookId,a=e.zoomValue;window.isVersoStat=n,this.updatePageLayout();const r={host:"",isEt1Spdf:this.isEt1SpdfContent,PDFassetURL:"",encpwd:"",requestheaderParams:{},zip:!1,pdfBookId:i,foxitAssetURL:o};this.pdfWrapper.createPDFViewer(r,a);const d=this;this.viewerRef.current.querySelector(".docViewer").addEventListener("wrpageLoaded",()=>{d.fetchAnnotation(t),d.manageLoading(!1),d.isEt1SpdfContent&&l.a.publish(x.q)}),d.isEt1SpdfContent&&(this.viewerRef.current.querySelector(".docViewer").addEventListener(x.s,()=>{l.a.publish(x.s)}),this.viewerRef.current.querySelector(".docViewer").addEventListener(x.r,()=>{l.a.publish(x.r)})),this.pdfWrapper.registerEvent("linkClicked",this.handleLinkClick),this.pdfWrapper.registerEvent("textSelected",this.annotationInterface.handleTextSelection),this.pdfWrapper.registerEvent("highlightClicked",this.annotationInterface.handleHighlightClicked)}}),this.viewerRef=i.a.createRef(),this.annotationIdStore={},this.newlyCreatedHighlightId=null,this.state={},window.isVersoStat=e.isFirstPageRight}componentWillReceiveProps(e){this.handleMedia(e.mediaObj)}componentDidMount(){var e=this.props;const t=e.currentPageId,o=e.pdfBookId;var n=this.context.learningContext;const i=n.isEt1SpdfContent,a=n.metadata.userRoleTypeId;window.frame1_bookIdReference=o,window.bookId1=o,window.bookId=o;const r=i?parseInt(t,10):parseInt(t.split("Page ")[1],10);window.sessionStorage.setItem("currentPageNo",r),window.sessionStorage.setItem(`frame1_${o}_curbookpageno`,r),this.removeDomElements(),this.bookType=x.y,this.isEt1SpdfContent=i,this.userRoleTypeId=a,this.pdfWrapper=new this.context.learningContext.metadata.PdfWrapper,i?(this.annotationInterface=new u.a(this),this.displaySearchResultsSubscription=l.a.on("displaySearchResults",(e,t)=>{e.forEach((e)=>{this.pdfWrapper.customSearchText(e,t)})})):this.annotationInterface=new f.a(this),this.props.setAnnotationInterface(this.annotationInterface),this.updatePdfFrame(),this.handleMedia(this.props.mediaObj)}componentDidUpdate(e){this.props.isDoublePage!==e.isDoublePage&&this.updatePdfFrame(),this.props.zoomValue&&this.props.zoomValue!==e.zoomValue&&(this.pdfWrapper.setPdfZoomLevel(this.props.zoomValue),this.pageZoomedHandler())}componentWillUnmount(){window.sessionStorage.removeItem("focPageNo"),this.displaySearchResultsSubscription&&this.displaySearchResultsSubscription()}render(){var e=this.context.learningContext;const t=e.features,o=e.isEt1SpdfContent,i=e.metadata.isYoungLearnerActive;var a=this.props;const r=a.annDataClient,d=a.currentPageId,l=a.getInternalId,g=a.getServerId,p=a.storeServerId,c=a.handleAnnotation,f=a.handleAnnotationSearch,u=a.handleCreateEditCard,b=a.isDoublePage,S=a.locale,w=a.showAnnotation,x=a.childComponents;let P="singlePagePDF",y="docViewer",v="spdfContainer";const C=o?"pdf-fwr-pc-main spdfMain":"pdf-fwr-pc-main";return b&&(P=" doublePagePDF",window.isVersoStat&&("Page 0"===d||"0"===d)&&(y+=" isHidden")),v=i?`${v} young-learner`:v,Object(n.createElement)("div",{className:v},r&&t.enableAnnotationWidget&&Object(n.createElement)(s.AnnotationComponent,{onChange:c,onAnnotationSearch:f,onCreateEditCard:u,getInternalId:l,getServerId:g,storeServerId:p,showAnnotation:w,showLabel:t&&t.showAnnotationLabel,showShare:t&&t.showShare,showHighlights:t&&t.showHighlights,showFlashcard:t&&t.showFlashcard,showSearch:t&&t.showSearch,showDictionary:t&&t.showDictionary,showSocialPost:t&&t.showSocialPost,showAudio:t&&t.showAudio,showCustomizeMenu:t&&t.showCustomizeMenu,theme:t&&t.theme,masterTheme:t&&t.masterTheme,annotationClient:r,pageId:d,locale:S,childComponents:x}),Object(n.createElement)("div",{className:"viewer-body",ref:this.viewerRef},Object(n.createElement)("div",{id:"pdfLoadingOverlay"}),Object(n.createElement)("div",{id:"main",className:C},Object(n.createElement)(m.a,{isVideoModalShown:this.state.isVideoModalShown,videoObject:this.state.videoObject,onClose:this.closePopup,bookId:this.props.pdfBookId,bookType:"SPDF"}),Object(n.createElement)(h.a,{isAudioModalShown:this.state.isAudioModalShown,isYoungLearnerActive:i,audioObject:this.state.audioObject,onClose:this.closePopup,bookId:this.props.pdfBookId,bookType:"SPDF"}),Object(n.createElement)("div",{id:"right",className:"pdf-fwr-pc-right"},Object(n.createElement)("div",{id:"toolbar",className:"pdf-fwr-toolbar"}),Object(n.createElement)("div",{id:"frame",className:P},Object(n.createElement)("div",{id:"docViewer",className:y}),this.doublePageView())))))}}t["default"]=C,C.propTypes={annDataClient:r.a.object,bookId:r.a.string,currentPageId:r.a.string,fetchAnnotation:r.a.func,locale:r.a.string,foxitAssetUrl:r.a.string,getInternalId:r.a.func,getServerId:r.a.func,storeServerId:r.a.func,handleAnnotation:r.a.func,isDoublePage:r.a.bool,isFirstPageRight:r.a.bool,mediaObj:r.a.object,onPageRequest:r.a.func,pagePlayList:r.a.arrayOf(r.a.object),pdfBookId:r.a.string,setAnnotationInterface:r.a.func,showAnnotation:r.a.bool,zoomValue:r.a.number,handleAnnotationSearch:r.a.func,handleCreateEditCard:r.a.func,childComponents:r.a.object},C.defaultProps={locale:"en",isDoublePage:!1,isFirstPageRight:!1,showAnnotation:!0},C.contextTypes={learningContext:r.a.shape(P.a).isRequired}}});
//# sourceMappingURL=0.3dbfffb5198cd98aa426.chunk.js.map