(window.webpackJsonpvegareader=window.webpackJsonpvegareader||[]).push([[29],{1495:function(e,a,t){"use strict";t.r(a);var r=t(15),n=t(55),i=t(9),o=t(10),s=t(27),c=t(26),p=t(0),d=t.n(p),g=t(111),u=t(1430),l=t(8),b=t(33),P=function(e){Object(s.a)(t,e);var a=Object(c.a)(t);function t(e){var o;Object(i.a)(this,t),(o=a.call(this,e)).handlePageChange=function(e,a,t){var r=o.props.onPageChange,i=a||0,s=o.props.preferences.isDoublePage;"bookmark"===t&&s&&(i-=1);var c=o.pagePlaylist&&o.pagePlaylist[i],p=[].concat(Object(n.a)(o.scrubberList),[o.scrubberList.push(a)]),d=p[p.length-2],g=o.props.currentPageDetail,u={destination:c.id,book_id:g.book_id,chapter_id:g.chapter_id,course_section_id:g.course_section_id,content_id:g.content_id,transaction_local_dt:new Date((new Date).toString().split("GMT")[0]+" UTC").toISOString().split("Z")[0]};"history"===t?b.a.scrubberHistory(u):"bookmark"===t?b.a.scrubberBookmark(u):p.length<2||a>d?b.a.scrubberForward(u):b.a.scrubberBackward(u),o.setState({pageRedirected:!0,updateInvalidPage:!1}),c&&r(c)},o.getMaxValue=function(){var e=o.pagePlaylist,a=o.props.preferences;return e&&a.isDoublePage&&e.length%2==0?o.pagePlaylist.length-2:o.pagePlaylist.length-1},o.getScrubberLabel=function(){var e=o.pagePlaylist,a=o.props,t=a.bookmarksArr,i=a.chapterContent,s=a.isSpdfContent,c=a.visitedPageList,p=t,d=i.chapterList||[],g=Object(n.a)(c),u=!1;g.length>=1&&g[1]?u=g[1].id:g[0]&&(u=g[0].id),s&&(u="Page ".concat(u),d=d.map((function(e){var a=e;return a.chapterId="Page ".concat(e.chapterId),a})),p=p.map((function(e){var a=Object(r.a)({},e);return a.uri="Page ".concat(e.uri),a})));var l=e.map((function(e,a){return{id:e.id,value:a,title:e.title,thumbnailSrc:e.href,isBookMarked:p.some((function(a){return a.uri==e.id})),isChapterOpener:!1,isLastVisited:!!u&&u===e.id,isRead:e.isRead}}));return d.forEach((function(a){var t=e.findIndex((function(e){return a.chapterId&&a.chapterId.indexOf("#")>-1?e.id===a.chapterId.split("#")[0]:e.id===a.chapterId}));t>0&&l.push({value:t-.5,title:"",thumbnailSrc:"",isBookMarked:!1,isChapterOpener:!0,isLastVisited:!1})})),l},o.handleGoToPage=function(e){var a=e.target.value;a=a.trim();var t=o.pagePlaylist,r=o.state.pageIndex,n=t.findIndex((function(e){return e.pagenumber.toLowerCase()===a.toLowerCase()})),i={id:-1,pagenumber:a},s=t[r],c=o.props.currentPageDetail,p={destination:i.pagenumber,book_id:c.book_id,chapter_id:c.chapter_id,course_section_id:c.course_section_id,content_id:c.content_id,transaction_local_dt:new Date((new Date).toString().split("GMT")[0]+" UTC").toISOString().split("Z")[0]};n>=0?(i=t[n],o.setState({updateInvalidPage:!1})):o.setState({updateInvalidPage:!0}),i.pagenumber!==s.pagenumber&&(o.props.goToPage(i),window.scroll(0,0),b.a.scrubberGoToPage(p))},o.handlePrevNextPageChange=function(e){var a=o.state.pageIndex,t=o.pagePlaylist,r=a,n=o.props.preferences.isDoublePage?2:1;if(e?r-=n:r+=n,!(r<0||r>=t.length)){var i=t[r];o.props.onPageChange(i,!e),window.scroll(0,0)}},o.pagePlaylist=o.props.playlists.playlist;var s=o.pagePlaylist.findIndex((function(a){return a.id===e.pageIdRequested})),c=o.pagePlaylist[s]&&(o.pagePlaylist[s].pagenumber||"");return o.scrubberList=[],o.state={currentPageNumber:c,updateInvalidPage:!1,pageIndex:s,pageRedirected:!0,pageId:e.pageIdRequested},o}return Object(o.a)(t,[{key:"render",value:function(){var e=this.props,a=e.classes,t=e.color,r=e.contentType,n=e.preferences,i=e.scrubberContainerRef,o=this.state,s=o.currentPageNumber,c=o.updateInvalidPage,p=o.pageIndex;return d.a.createElement("div",{className:a.scrubberContainer,ref:function(e){i(e)}},d.a.createElement(u.VegaScrubber,{color:t,contentType:r,pageCount:this.getMaxValue(),label:this.getScrubberLabel(),value:p,goToPage:this.handleGoToPage,currentPageId:c?"":s,onPageChange:this.handlePageChange,onPrevNextPageChange:this.handlePrevNextPageChange,hideGoToPage:!0,step:n.isDoublePage?2:1}))}}],[{key:"getDerivedStateFromProps",value:function(e,a){var t=e.pagePlaylist.findIndex((function(a){return a.id===e.pageIdRequested})),r=a.pageRedirected?t:a.pageIndex,n=e.pagePlaylist[r]&&(e.pagePlaylist[r].pagenumber||"");return a.updateInvalidPage&&a.pageId!==e.pageIdRequested?{currentPageNumber:n,pageIndex:r,pageId:e.pageIdRequested,updateInvalidPage:!1}:{currentPageNumber:n,pageIndex:r,pageId:e.pageIdRequested}}}]),t}(p.PureComponent);P.defaultProps={bookmarksArr:[],chapterContent:{},currentPageDetail:{},color:"default",contentType:"",goToPage:function(){},onPageChange:function(){},pageIdRequested:"",pagePlaylist:[],playlists:{},preferences:{},scrubberContainerRef:function(){},visitedPageList:[]},a.default=Object(l.a)((function(){return{scrubberContainer:{height:"calc(100% - 12px)"}}}))(Object(g.inject)("playlists")(Object(g.observer)(P)))}}]);